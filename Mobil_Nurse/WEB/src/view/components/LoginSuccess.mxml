<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
		xmlns:s="library://ns.adobe.com/flex/spark"
		backgroundColor="#E3F2F2" creationComplete="shitHappens(event)"
		initialize="onInitialization(event)" title="Please check your personal Data">
	
	<fx:Declarations>
		<!-- Platzieren Sie nichtvisuelle Elemente (z.Â B. Dienste, Wertobjekte) hier -->
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import model.vo.auto.Employee;
			
			import mx.events.FlexEvent;
			
			/** PureMVC PART PureMVC Part PureMVC PART **/
			
			public static const NAME:String = 'LoginSuccess';
			public static const CLICKED:String = NAME + "Clicked";
			public static const CLICKEDFORWARD:String = NAME + "ClickedFoward";
			
			public function onInitialization(event:FlexEvent):void {
				this.id = NAME;
				trace("** -- ON INITIALIZE LOGIN SUCCESS -- **")
			}
			
			public function fireMVCLogout():void {
				trace("LoginSuccessView - ClickEvent - TRYLOGOUT");
				dispatchEvent( new Event( CLICKED ) );
			}
			
			public function fireMVCGoForward():void {
				trace("LoginSuccessView - ClickEvent - TRYLOGOUT");
				dispatchEvent( new Event( CLICKEDFORWARD ) );
			}
			
			/** PureMVC PART PureMVC Part PureMVC PART **/
			
			public function logoutView():void {
				navigator.popView();
			}
			
			public function goForward():void {
				navigator.pushView(AllPatientsTable);
			}
			
			/** for the picture **/
			
			private var loader:Loader = new Loader();
			private var bitmapdata:BitmapData;
			
			protected function shitHappens(event:FlexEvent):void
			{
				var bta:ByteArray = data.picture as ByteArray;
				loader.contentLoaderInfo.addEventListener(Event.COMPLETE, getBitmapData);
				loader.loadBytes(bta);
			}
			
			protected function getBitmapData(event:Event):void
			{
				var content:* = loader.content;
				var bitmapdata:BitmapData = new BitmapData(content.width, content.height ,true,0x00000000);
				var matrix:Matrix = new Matrix();
				bitmapdata.draw(content, matrix, null, null, null, true);
				if(bitmapdata != null){
					employee_picture.source = new Bitmap(bitmapdata);
				}
			}
			
		]]>
	</fx:Script>
	
	<s:navigationContent>
		<s:Button label="Logout" click="fireMVCLogout()"/>
	</s:navigationContent>
	<s:actionContent>
		<s:Button id="showPatientsTable" width="121" height="32" label="Next"
				  click="fireMVCGoForward()"/>
	</s:actionContent>
	
	<s:HGroup width="705" horizontalCenter="0" verticalCenter="0">
		<s:Form x="89" width="400" height="300" styleName="checkData">
			<s:FormItem width="100%" label="Personalnumber: " fontSize="22" fontStyle="normal"
						textAlign="center">
				<s:Label id="dataPrsNumber" width="170" color="#608785" fontSize="22"
						 text="{data.prsnumber}" textAlign="right"/>
			</s:FormItem>
			
			<s:FormItem width="100%" label="Username: " fontSize="22">
				<s:Label id="dataUsername" width="170" color="#608785" fontSize="22"
						 text="{data.username}" textAlign="right"/>
			</s:FormItem>
			
			<s:FormItem width="100%" label="Firstname: " fontSize="22">
				<s:Label id="dataFirstName" width="170" color="#608785" fontSize="22"
						 text="{data.firstname}" textAlign="right"/>
			</s:FormItem>
			
			<s:FormItem width="100%" label="Lastname: " fontSize="22">
				<s:Label id="dataName" width="170" color="#608785" fontSize="22" text="{data.name}"
						 textAlign="right"/>
			</s:FormItem>
			
			<s:FormItem width="100%" label="Your Job: " fontSize="22">
				<s:Label id="dataJob" width="170" color="#608785" fontSize="22" text="{data.job}"
						 textAlign="right"/>
			</s:FormItem>
			
			<s:FormItem width="100%" label="Your Birth: " fontSize="22">
				<s:Label id="dataBirth" width="170" color="#608785" fontSize="22" text="{data.birth}"
						 textAlign="right"/>
			</s:FormItem>
		</s:Form>
		<s:Image id="employee_picture" x="668" y="292" width="300" height="300"/>
	</s:HGroup>
	<s:Label y="171" fontSize="22" horizontalCenter="236" text="Is it really you?"/>
</s:View>
